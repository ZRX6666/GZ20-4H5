<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
    <style>
        input[type=checkbox] {
            opacity: 0.2;
            /* display: none; */
        }

        label {
            border: 1px solid green;
            border-radius: 5px;
            padding: 0 30px;
            margin: 0 10px;
            line-height: 2em;
            display: inline-block;

        }

        label.checked {
            /* background: red; */
            border-color: #00a4ff;
            background: url('http://www.jq22.com/demo/jqueryrichui201901242258/img/checked.svg');
            background-repeat: no-repeat;
            background-position: right bottom;
            background-size: auto 50%;
        }
    </style>
</head>

<body>
    <form action="" method="get">

        <label class="all">
            <span>全选</span>
        </label>
        <label class="fan">
            <span>反选</span>
        </label>

        <label>
            <input type="checkbox"" name=" fav" value="苹果">
            <span>苹果</span>
        </label>

        <label>
            <input type="checkbox" name="fav" value="橘子">
            <span>橘子</span>
        </label>
        <label>
            <input type="checkbox" name="fav" value="葡萄">
            <span>葡萄</span>
        </label>

        <input type="submit" value="提交">
    </form>

    <script>

        var allChecked = false

        $('form label').click(function (event) {
            // event.preventDefault()

            if ($(this).find('span').text() === '全选') {
                allChecked = !allChecked
                $('form label').find('input').prop('checked', allChecked)

            }

            if ($(this).find('span').text() === '反选') {

                $('form label').find('input').each(function (index, element) {
                    $(element).prop('checked', !$(element).prop('checked'))
                })
            }

            var arr = []
            // 处理所有 更改视图
            $('form label').each(function (index, element) {
                var isChecked = $(element).find('input').prop('checked')
                if (isChecked !== undefined) {
                    arr.push(isChecked)
                }

                if (isChecked === true) {
                    $(element).addClass('checked')
                } else if (isChecked === false) {
                    $(element).removeClass('checked')
                }
            })

            // console.log(arr)
            var isAllChecked = arr.every(function (element) {
                return element
            })
            console.log(isAllChecked)


            if (isAllChecked) {
                // console.log('xx')
                $('.all').addClass('checked')
            } else {
                $('.all').removeClass('checked')
            }
        })
    </script>
</body>

</html>